# Please refer to `README.md` for how to setup this GitHub action runner
version: "3.9"

services:
  runner:
    image: ghcr.io/actions/actions-runner:2.328.0
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /data/miles_ci:/data/miles_ci
      # it requires this folder
      - /home/runner/externals:/home/runner/externals
      - ./entrypoint.sh:/entrypoint.sh:ro
    deploy:
      replicas: 8
    restart: always
    environment:
      RUNNER_ALLOW_RUNASROOT: "1"
    privileged: true
    user: root
    entrypoint: ["/entrypoint.sh"]
